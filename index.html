<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>DuperChat</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin:0; display:flex; height:100vh; }
    #sidebar { width:200px; background:#f2f2f2; padding:10px; }
    #chat { flex:1; display:flex; flex-direction:column; }
    #messages { flex:1; overflow-y:auto; padding:10px; }
    #inputBar { display:flex; }
    #inputBar input { flex:1; padding:10px; border:1px solid #ccc; }
    #inputBar button { padding:10px; }
    .msg { margin:5px 0; padding:8px; border-radius:5px; background:#e6e6ff; }
  </style>
</head>
<body>
  <div id="sidebar">
    <h3>DuperChat</h3>
    <p><b>Online:</b></p>
    <ul id="users"></ul>
  </div>

  <div id="chat">
    <div id="messages"></div>
    <div id="inputBar">
      <input id="msgInput" placeholder="Type a message...">
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

<script>
  const socket = io();
  let username = prompt("Enter your name:");
  socket.emit("identify", username);

  const usersList = document.getElementById("users");
  const messagesDiv = document.getElementById("messages");
  const msgInput = document.getElementById("msgInput");

  socket.on("users", (users) => {
    usersList.innerHTML = "";
    users.forEach(u => {
      const li = document.createElement("li");
      li.textContent = u;
      usersList.appendChild(li);
    });
  });

  socket.on("message", (msg) => {
    const div = document.createElement("div");
    div.className = "msg";
    div.textContent = msg.user + ": " + msg.text;
    messagesDiv.appendChild(div);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  });

  function sendMessage() {
    if (msgInput.value.trim() === "") return;
    const msg = { user: username, text: msgInput.value };
    socket.emit("message", msg);
    msgInput.value = "";
  }
</script>
</body>
</html>
